<!doctype html>
<html class="no-js" lang="en"> <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Kirjastohankkeet demo</title>
    <link rel="stylesheet" href="css/foundation.css" />
    <!--<link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>-->
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,300,400,700,600' rel='stylesheet' type='text/css'>
    <script src="js/vendor/modernizr.js"></script>
    <!--<script src="//ajax.googleapis.com/ajax/libs/webfont/1.4.7/webfont.js"></script>-->
    <script>
//      WebFont.load({
//        google: {
//          families: ['Open Sans']
//        }
//      });
    </script>
    <script type="text/javascript">
      function export_svg() {
        $('svg').svg();
        var xml = $('svg').svg('get').toSVG();
        $('#svgexport').html(xml.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;'));
      }
    </script>
    <link rel="stylesheet" type="text/css" href="css/css2.css">
  </head>
  <body id='kirjastovis_container'>
<!--    <a href="http://gfx.kirjastot.fi/kifi/kifi-banner-pro-fi.html"><img style="position: absolute; top: 65px; left: 0; border: 0;" src="http://gfx.kirjastot.fi/kifi/kifi-banner-pro-fi.html" alt="xxx"></a>
    {% include nav.html %} -->
		
    <div class="row">
      <div class="large-15 columns">
			  <div id="hvuosi" class="control">
            <h3>Year</h3>
            <div class="control-links">
            <a id="all" class="active">All</a> | 
            <a id="2014">2014</a> | 
            <a id="2013">2013</a> | 
            <a id="2012">2012</a> | 
            <a id="2011">2011</a> | 
				</div>
<!--          <div class="time_nav left clickable unselectable">
            <div class="time_arrow"> &lt; </div>
            <div class="time_buttons">
              <div>edellinen<br/>vuosi</div>
            </div>
          </div>
          <div class="time_nav right unselectable">
            <div class="time_arrow"> &gt; </div>
            <div class="time_buttons">
              <div>seuraava<br/>vuosi</div>
            </div>
          </div> -->
        <div id="viz_nav_container">
          <div id="viz_nav_inner_container">
<!--            <div class="viz_nav year selected" data-name="year" data-year='2014'> 2014 </div> -->
            
						<div class="viz_nav btn" data-name="teema">
              <div class="sub_header">Tarkastele</div>
              <div class="header">Teemoittain</div>
            </div>
            <div class="viz_nav btn" data-name="vaikutusalue">
              <div class="sub_header">Tarkastele</div>
              <div class="header">Vaikutusalueittain</div>
            </div>
            <div class="viz_nav btn" data-name="maakunta">
              <div class="sub_header">Tarkastele</div>
              <div class="header">Maakunnittain</div>
            </div>
            <div class="viz_nav btn" data-name="kunta">
              <div class="sub_header">Tarkastele</div>
              <div class="header">Kunnittain</div>
            </div>
            <div class="viz_nav btn" data-name="amount">
              <div class="sub_header">Tarkastele</div>
              <div class="header">Koon mukaan</div>
            </div>
						<div id="search_section" class="control">
<form id="search_form" action="" method="post">
<p class="search_title">Etsi hanketta <input type="text" class="text-input" id="search" value=""/></p>
</form>
</div>
<!--					<div id="format" class="control">
             <input type="checkbox" id="check1"><label for="check1">A</label>
             <input type="checkbox" id="check2"><label for="check2">testi</label>
             <input type="checkbox" id="check3"><label for="check3">C</label>
          </div>
					<div id="search_section" class="control">
<form id="search_form" action="" method="post">
<p class="search_title">Etsi hanketta <input type="text" class="text-input" id="search" value=""/></p>
</form>
</div> -->
        </div>
<!-- 				<div class="row"> -->
				</div>
            <form id="myForm">
									<h6>Tarkastele kohderyhmitt&auml;in:</h6>
									<input type="radio" name="radioName" value=";" /> Kaikki
									<input type="radio" name="radioName" value="nuoret" /> Nuoret
									<input type="radio" name="radioName" value="vanhukset" /> Vanhukset
									<input type="radio" name="radioName" value="lapset" /> Lapset
									<input type="radio" name="radioName" value="asiakkaat" /> Asiakkaat
									<input type="radio" name="radioName" value="henkilökunta" /> Henkil&ouml;kunta
						</form>

				</div>		
      </div>
    </div>

    <br />
    <div class="row full-width">
      <div id="vis-container" class="large-12 columns">
			    <div id='right-sidebar'>
<!--					   <h2>
                        V&auml;rit:</h2>
						<div>
            <select id='color-everything-by'>
                            <option value=''></option>
                        </select></div>
			       <div> -->
                 <a id='right-sidebar-toggle' href='#'>V&auml;rikoodit</a>
							 
             </div> 
             <div id='right-sidebar-container'>
						   <p> Valitse pallojen v&auml;ritys: (piilota klikkaamalla)</p>
						  <div>
              <select id='color-everything-by'>
                 <option value=''></option>
                 </select></div>
							<div id='right-sidebar-color-container'>
							</div>
             </div>
						 
<!--        <div id="vis"></div>
<!--				  <div id='right-sidebar'>
<!--             <h2>V&auml;rit:</h2>
						<div>
              <select id='color-everything-by'>
                 <option value=''></option>
              </select></div>
            </div>-->
<!--						  <div>
                 <a id='right-sidebar-toggle' href='#'>V&auml;rikoodit</a>
              </div>
                  <div id='right-sidebar-container'>
                  </div>
          </div> -->
				  </div>
					<div id="vis"></div>
      </div>
    </div>
		

    <script type="text/javascript" src="js/vendor/jquery.js"></script>
    <script type="text/javascript" src="js/jquery.svg.js"></script>
    <script type="text/javascript" src="js/foundation.min.js"></script>
    <!--
    <script type="text/javascript" src="js/dat.gui.min.js"></script>
    <script type="text/javascript" src="js/d3.v3.js"></script>
    -->
    <script type="text/javascript" src="js/d3.v3.min.js"></script>
    <script type="text/javascript" src="js/util.js"></script>
    <script type="text/javascript" src="js/common.js"></script>
    <script type="text/javascript" src="js/d3.tip.v0.6.3.js"></script>
    <script type="text/javascript" src="js/libs/jquery.animate-colors-min.js"></script>

    <!--
    <script defer src="js/plugins.js"></script>
    -->
    <script defer src="js/script.js"></script>
    <script src="js/CustomTooltip.js"></script>
<!--    <script src="js/d3.csv.min.js"></script>
		<!--
    <script src="js/libs/coffee-script.js"></script>
    <script src="js/libs/d3.geom.min.js"></script>
		-->
    <script type="text/javascript" src="js/vis2.js"></script>
    <script type="text/javascript" src="js/lodash_2.4.1.js"></script>
    <script type="text/javascript" src="js/libs/queue.v1.min.js"></script>
    <script type="text/javascript">
        $(function() {
            var controlsVisible = true;
            $('#right-sidebar-container').click(function() {
                controlsVisible = ! controlsVisible;
                if (controlsVisible)
                    $('#right-sidebar-color-container').slideDown('fast');
                else 
                    $('#right-sidebar-color-container').slideUp('fast');
            });
        });

        var initialise_form = function (selectionOptions) {


            var colorSelect = $('#color-everything-by');
            for (var opt in selectionOptions) {
                var lookup = selectionOptions[opt];
                colorSelect.append('<option value="' + lookup.key + '">' + lookup.title + '</option>');
            }
            var ResetColors = function () {
                var colorBy = colorSelect.val();
                console.log(colorBy);
                color_by(colorBy);
            };


            colorSelect.change(ResetColors);


        };

        function get_distinct_values(records, keyType, key) {
            var allValues = {};
            for (var i in records) {
                var value = records[i][key];
                allValues[value] = true;
            }

            var allValuesArray = [];
            for (var i in allValues)
                allValuesArray.push(i);

            if (keyType == 'testi1')
                allValuesArray.sort(function (a, b) { return Number(a) - Number(b); });
            else
                allValuesArray.sort();
            return allValuesArray
        }

        function keyToLookup(key) {
            var firstPartEnds = key.indexOf('_');
            if (firstPartEnds <= 0)
                return { key: key, type: key, title: key };

            var firstPart = key.substring(0, firstPartEnds);
            var secondPart = key.substring(firstPartEnds + 1);

            return { key: key, type: firstPart, title: secondPart };
        }
<!--        function render_filters_colors_and_groups(csv) { -->
        function render_colors(records) { 
            var first = records[0];
            var lookups = [];
            for (var key in first) {
                var lookup = keyToLookup(key);
                switch (lookup.type) {
                    case "Lookup":
                    case "offi":
                    case "Testi2":
                        lookups.push(lookup);
                        break;
                    default:
                        break;
                }
            }


            initialise_form(lookups);
        }

        function hide_color_chart() {
//            var right = $('#right-sidebar');
						var right = $('#right-sidebar-toggle');
            var rightContainer = $('#right-sidebar-color-container');
            rightContainer.fadeOut(500, function () {
                rightContainer.empty();
            });
        }
        function show_color_chart(what_to_color_by, color_mapper) {
//            var right = $('#right-sidebar');            
						var right = $('#right-sidebar-toggle');
            rightContainer = $('#right-sidebar-color-container');
            right.fadeOut(500, function () {
               rightContainer.empty();

//                var lookup = keyToLookup(what_to_color_by);
//                $('<h3>' + lookup.title + '</h3>').appendTo(rightContainer);

                var table = $('<table />');
                for (var key in color_mapper) {
                    var row = $('<tr/>');

                    var cell = $('<td/>');
                    var square = $('<div style="width: 15px; height: 15px; background: ' + color_mapper[key] + ';">&nbsp;</div>');
                    square.appendTo(cell);
                    cell.appendTo(row);

                    cell = $('<td/>');
                    cell.text(' ' + key + ' ');
                    cell.appendTo(row);
                    row.appendTo(table);
                }

                table.appendTo(rightContainer);
//                right.fadeIn(500);
//								right.fadeIn(0);
            });
        }
			$(document).ready(function() {
//			  $(".chzn-select").chosen();
      $(document).ready(function() {
			   $('.control-links a').click(function() {
              $(this).siblings().removeClass('active');
              $(this).addClass('active');
              });
//			 $(".chzn-select").chosen();
		   $('#view_by a').click(function() {
            var view_by = $(this).attr('id');
            $('#view_by a').removeClass('active');
            $(this).toggleClass('active');
            toggle_size(view_by);
            return false;
          });
			 $('#hvuosis a').click(function() {
              var new_options = {"hvuosi": $(this).attr("id")};
              update_options(new_options);
              });
        });
    });
  </script>
    <script>
     (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-50186636-1', 'axelson.github.io');
      ga('send', 'pageview');

    </script> 

  </body>
</html>
